---- Finish the Model Loading ----
---- Finish the Dataset Loading ----

  0%|                                                                                                                                                                                  | 0/750 [00:00<?, ?it/s]torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /opt/conda/conda-bld/pytorch_1708025829503/work/aten/src/ATen/native/TensorShape.cpp:3549.)












































































































































































































































































































































































































































































































































































































































































































































































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 750/750 [43:35<00:00,  3.49s/it]
  0%|                                                                                                                                                                                   | 0/10 [00:00<?, ?it/s]
lag-reg: SSIM ---> 0.8513768315315247 , PSNR ---> 39.465572357177734
 67%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                        | 10/15 [00:00<00:00, 19.05it/s]
Pixel Acc is :  tensor(0.9957)
Dice Score is :  tensor(0.8703)
Precision is :  tensor(0.8416)
Specificity is :  tensor(0.9972)
Recall is :  tensor(0.9010)
ES Frame Number :  14
 10%|█████████████████                                                                                                                                                          | 1/10 [00:05<00:45,  5.06s/it]
 20%|██████████████████████████████████▏                                                                                                                                        | 3/15 [00:00<00:00, 26.48it/s]
Pixel Acc is :  tensor(0.9937)
Dice Score is :  tensor(0.7811)
Precision is :  tensor(0.7037)
Specificity is :  tensor(0.9952)
Recall is :  tensor(0.8778)
ES Frame Number :  15
 20%|██████████████████████████████████▏                                                                                                                                        | 2/10 [00:07<00:28,  3.58s/it]
 73%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                             | 11/15 [00:00<00:00, 24.94it/s]
Pixel Acc is :  tensor(0.9954)
Dice Score is :  tensor(0.8246)
Precision is :  tensor(0.7657)
Specificity is :  tensor(0.9966)
Recall is :  tensor(0.8932)
ES Frame Number :  6
lag-reg: SSIM ---> 0.8403264880180359 , PSNR ---> 38.39503860473633
Pixel Acc is :  tensor(0.9942)
Dice Score is :  tensor(0.7983)
Precision is :  tensor(0.7312)
Specificity is :  tensor(0.9957)
Recall is :  tensor(0.8789)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:00<00:00, 24.50it/s]
 40%|████████████████████████████████████████████████████████████████████▍                                                                                                      | 4/10 [00:10<00:13,  2.26s/it]
lag-reg: SSIM ---> 0.8439355492591858 , PSNR ---> 32.87531661987305
Pixel Acc is :  tensor(0.9947)
Dice Score is :  tensor(0.8498)
Precision is :  tensor(0.7916)
Specificity is :  tensor(0.9960)
Recall is :  tensor(0.9173)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:00<00:00, 28.46it/s]
 50%|█████████████████████████████████████████████████████████████████████████████████████▌                                                                                     | 5/10 [00:12<00:10,  2.01s/it]
lag-reg: SSIM ---> 0.8170627951622009 , PSNR ---> 33.599761962890625
Pixel Acc is :  tensor(0.9955)
Dice Score is :  tensor(0.8437)
Precision is :  tensor(0.8057)
Specificity is :  tensor(0.9971)
Recall is :  tensor(0.8854)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:00<00:00, 17.68it/s]
 60%|██████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                    | 6/10 [00:14<00:08,  2.05s/it]
lag-reg: SSIM ---> 0.8304950594902039 , PSNR ---> 35.06793212890625
Pixel Acc is :  tensor(0.9948)
Dice Score is :  tensor(0.8655)
Precision is :  tensor(0.8262)
Specificity is :  tensor(0.9964)
Recall is :  tensor(0.9086)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:00<00:00, 26.78it/s]
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                   | 7/10 [00:15<00:05,  1.87s/it]
lag-reg: SSIM ---> 0.8165364265441895 , PSNR ---> 31.739734649658203
Pixel Acc is :  tensor(0.9899)
Dice Score is :  tensor(0.7283)
Precision is :  tensor(0.6588)
Specificity is :  tensor(0.9929)
Recall is :  tensor(0.8141)
ES Frame Number :  10
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:00<00:00, 21.98it/s]
 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                  | 8/10 [00:17<00:03,  1.84s/it]
 47%|███████████████████████████████████████████████████████████████████████████████▊                                                                                           | 7/15 [00:00<00:00, 31.16it/s]
Pixel Acc is :  tensor(0.9917)
Dice Score is :  tensor(0.6117)
Precision is :  tensor(0.5283)
Specificity is :  tensor(0.9941)
Recall is :  tensor(0.7266)
ES Frame Number :  5
 90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                 | 9/10 [00:19<00:01,  1.73s/it]
 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                  | 12/15 [00:00<00:00, 22.69it/s]
Pixel Acc is :  tensor(0.9872)
Dice Score is :  tensor(0.5800)
Precision is :  tensor(0.4820)
Specificity is :  tensor(0.9904)
Recall is :  tensor(0.7279)
ES Frame Number :  6
SSIM: Mean:0.8236773610115051, Std:0.026148052886128426
PSNR: Mean:34.65809631347656, Std:4.750965595245361
DICE: Mean:0.775325345993042, Std:0.09874115366656082
RV_DICE: Mean:0.7748013734817505, Std:0.08064958453178406
MYO_DICE: Mean:0.6485407948493958, Std:0.11928126960992813
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:21<00:00,  2.14s/it]













































































































































































































































































































































































































































































































































































































































































































































































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 750/750 [45:43<00:00,  3.66s/it]
  0%|                                                                                                                                                                             | 0/10 [00:00<?, ?it/s]
lag-reg: SSIM ---> 4.3519708670114454e-11 , PSNR ---> 0.628687858581543
 60%|███████████████████████████████████████████████████████████████████████████████████████████████████                                                                  | 9/15 [00:00<00:00, 12.57it/s]
Pixel Acc is :  tensor(0.9839)
Dice Score is :  tensor(3.9585e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(3.9585e-10)

 10%|████████████████▌                                                                                                                                                    | 1/10 [00:05<00:50,  5.61s/it]
  7%|███████████                                                                                                                                                          | 1/15 [00:00<00:02,  5.70it/s]

 20%|█████████████████████████████████                                                                                                                                    | 2/10 [00:09<00:38,  4.87s/it]
Pixel Acc is :  tensor(0.9871)
Dice Score is :  tensor(4.9351e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(4.9351e-10)
ES Frame Number :  15
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:00<00:00, 18.18it/s]
 30%|█████████████████████████████████████████████████▌                                                                                                                   | 3/10 [00:12<00:26,  3.78s/it]
Pixel Acc is :  tensor(0.9878)
Dice Score is :  tensor(5.2064e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(5.2064e-10)
ES Frame Number :  6
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:00<00:00, 28.43it/s]
 40%|██████████████████████████████████████████████████████████████████                                                                                                   | 4/10 [00:14<00:17,  2.99s/it]
Pixel Acc is :  tensor(0.9869)
Dice Score is :  tensor(4.8412e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(4.8412e-10)
ES Frame Number :  12
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:00<00:00, 18.48it/s]
 50%|██████████████████████████████████████████████████████████████████████████████████▌                                                                                  | 5/10 [00:16<00:13,  2.66s/it]
Pixel Acc is :  tensor(0.9837)
Dice Score is :  tensor(3.9073e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(3.9073e-10)
ES Frame Number :  12
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:00<00:00, 19.55it/s]
 60%|███████████████████████████████████████████████████████████████████████████████████████████████████                                                                  | 6/10 [00:18<00:10,  2.55s/it]
Pixel Acc is :  tensor(0.9864)
Dice Score is :  tensor(4.6668e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(4.6668e-10)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:00<00:00, 18.46it/s]
 87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                     | 13/15 [00:00<00:00, 17.23it/s]
lag-reg: SSIM ---> 6.181428979790127e-11 , PSNR ---> 0.7141693830490112
Pixel Acc is :  tensor(0.9814)
Dice Score is :  tensor(3.4243e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(3.4243e-10)
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                 | 7/10 [00:20<00:07,  2.48s/it]
 27%|████████████████████████████████████████████                                                                                                                         | 4/15 [00:00<00:00, 13.36it/s]
lag-reg: SSIM ---> 1.2682706274080857e-10 , PSNR ---> 1.1592557430267334
Pixel Acc is :  tensor(0.9834)
Dice Score is :  tensor(3.8294e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(3.8294e-10)

 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                 | 8/10 [00:23<00:04,  2.47s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:00<00:00, 18.59it/s]
 90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                | 9/10 [00:25<00:02,  2.47s/it]
Pixel Acc is :  tensor(0.9910)
Dice Score is :  tensor(7.0274e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(7.0274e-10)
ES Frame Number :  5
lag-reg: SSIM ---> 4.6529419206464695e-11 , PSNR ---> 1.2433384656906128
 53%|████████████████████████████████████████████████████████████████████████████████████████                                                                             | 8/15 [00:01<00:01,  5.74it/s]
Pixel Acc is :  tensor(0.9878)
Dice Score is :  tensor(5.2230e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(5.2230e-10)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:29<00:00,  3.00s/it]
  0%|                                                                                                                                                                            | 0/750 [00:00<?, ?it/s]
SSIM: Mean:6.571342081596043e-11, Std:2.8727862103061774e-11
PSNR: Mean:0.766425609588623, Std:0.31602874398231506
DICE: Mean:4.701946915153244e-10, Std:9.791158171989936e-11
RV_DICE: Mean:1.7281390762846627e-09, Std:5.260902824488767e-10
MYO_DICE: Mean:1.4844425688664842e-09, Std:2.540337384893121e-10














































































































































































































































































































































































































































































































































































































































































































































































100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 750/750 [50:24<00:00,  4.03s/it]
  0%|                                                                                                                                                                             | 0/10 [00:00<?, ?it/s]
lag-reg: SSIM ---> 4.613619208893027e-11 , PSNR ---> 0.6280570030212402
 27%|████████████████████████████████████████████                                                                                                                         | 4/15 [00:00<00:00, 14.35it/s]
Pixel Acc is :  tensor(0.9839)
Dice Score is :  tensor(3.9585e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(3.9585e-10)
 10%|████████████████▌                                                                                                                                                    | 1/10 [00:03<00:35,  3.93s/it]
  0%|                                                                                                                                                                             | 0/15 [00:00<?, ?it/s]
lag-reg: SSIM ---> 3.9181921596131986e-11 , PSNR ---> 0.34217172861099243
Pixel Acc is :  tensor(0.9871)
Dice Score is :  tensor(4.9351e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(4.9351e-10)
ES Frame Number :  15
 20%|█████████████████████████████████                                                                                                                                    | 2/10 [00:05<00:22,  2.80s/it]
 33%|███████████████████████████████████████████████████████                                                                                                              | 5/15 [00:00<00:00, 23.05it/s]
Pixel Acc is :  tensor(0.9878)
Dice Score is :  tensor(5.2064e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(5.2064e-10)
ES Frame Number :  6
 30%|█████████████████████████████████████████████████▌                                                                                                                   | 3/10 [00:07<00:16,  2.41s/it]
 40%|██████████████████████████████████████████████████████████████████                                                                                                   | 6/15 [00:00<00:00, 19.62it/s]
Pixel Acc is :  tensor(0.9869)
Dice Score is :  tensor(4.8412e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(4.8412e-10)
ES Frame Number :  12
 40%|██████████████████████████████████████████████████████████████████                                                                                                   | 4/10 [00:09<00:13,  2.22s/it]
 33%|███████████████████████████████████████████████████████                                                                                                              | 5/15 [00:00<00:00, 14.85it/s]
Pixel Acc is :  tensor(0.9837)
Dice Score is :  tensor(3.9073e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(3.9073e-10)

 50%|██████████████████████████████████████████████████████████████████████████████████▌                                                                                  | 5/10 [00:12<00:11,  2.38s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:01<00:00, 14.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:01<00:00, 15.38it/s]
Pixel Acc is :  tensor(0.9864)
Dice Score is :  tensor(4.6668e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(4.6668e-10)
ES Frame Number :  7
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:00<00:00, 24.98it/s]
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                 | 7/10 [00:17<00:07,  2.35s/it]
Pixel Acc is :  tensor(0.9814)
Dice Score is :  tensor(3.4243e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(3.4243e-10)
ES Frame Number :  8
lag-reg: SSIM ---> 1.2598544429920366e-10 , PSNR ---> 1.1583588123321533
Pixel Acc is :  tensor(0.9834)
Dice Score is :  tensor(3.8294e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(3.8294e-10)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:00<00:00, 30.73it/s]
 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                 | 8/10 [00:18<00:04,  2.06s/it]
lag-reg: SSIM ---> 8.500835452229794e-11 , PSNR ---> 1.1972484588623047
Pixel Acc is :  tensor(0.9910)
Dice Score is :  tensor(7.0274e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(7.0274e-10)
ES Frame Number :  5
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:00<00:00, 31.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [00:00<00:00, 30.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:21<00:00,  1.66s/it]
Pixel Acc is :  tensor(0.9878)
Dice Score is :  tensor(5.2230e-10)
Precision is :  tensor(1.)
Specificity is :  tensor(1.)
Recall is :  tensor(5.2230e-10)
ES Frame Number :  6
SSIM: Mean:6.559158771679563e-11, Std:2.8336858901023554e-11
PSNR: Mean:0.766456127166748, Std:0.3158853054046631
DICE: Mean:4.701946915153244e-10, Std:9.791158171989936e-11
RV_DICE: Mean:1.7281390762846627e-09, Std:5.260902824488767e-10
MYO_DICE: Mean:1.4844425688664842e-09, Std:2.540337384893121e-10
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:21<00:00,  2.18s/it]

















































































































































































































































































































































































































 54%|██████████████████████████████████████████████████████████████████████████████████████▊                                                                           | 402/750 [22:56<18:02,  3.11s/it]Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7faf717951f0>
Traceback (most recent call last):
  File "/home/jyangcu/miniconda3/envs/pytorch/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1479, in __del__
    self._shutdown_workers()
  File "/home/jyangcu/miniconda3/envs/pytorch/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1443, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/jyangcu/miniconda3/envs/pytorch/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/jyangcu/miniconda3/envs/pytorch/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/jyangcu/miniconda3/envs/pytorch/lib/python3.8/multiprocessing/connection.py", line 930, in wait
    ready = selector.select(timeout)
  File "/home/jyangcu/miniconda3/envs/pytorch/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt:
 54%|██████████████████████████████████████████████████████████████████████████████████████▊                                                                           | 402/750 [22:57<19:52,  3.43s/it]
Traceback (most recent call last):
  File "train_acdc.py", line 435, in <module>
    main(args.local_rank, args)
  File "train_acdc.py", line 390, in main
    Train(args)
  File "train_acdc.py", line 66, in __init__
    self.train(args)
  File "train_acdc.py", line 80, in train
    loss, inf_flow_all, neg_inf_flow_all, lag_flow, lag_register, forward_regsiter, backward_regsiter = self.RViT(input_vids.to(args.device), hidden)
  File "/home/jyangcu/miniconda3/envs/pytorch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jyangcu/miniconda3/envs/pytorch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jyangcu/GPTrack/models/GPTrack_3D.py", line 615, in forward
    neg_lag_flow = self.lag_flow(torch.flip(neg_inf_flow_cross, dims=[2]))
  File "/home/jyangcu/miniconda3/envs/pytorch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jyangcu/miniconda3/envs/pytorch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jyangcu/GPTrack/models/GPTrack_3D.py", line 422, in forward
    lag_flow_z = self.spatial_transform(src_z, sum_flow.squeeze(2))
  File "/home/jyangcu/miniconda3/envs/pytorch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jyangcu/miniconda3/envs/pytorch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jyangcu/GPTrack/models/GPTrack_3D.py", line 360, in forward
    grid = grid.type(torch.FloatTensor).to(flow.device)
KeyboardInterrupt